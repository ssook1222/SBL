{

    "title" : "1월 1주차 문제 풀이 기록",
    "date" : "23-01-07 ~ 23-01-08",
    
    "subTitle1" : "1. 오프라인/온라인 판매 데이터 통합하기",
    "subTitle2" : "2. 12세 이하인 여자 환자 목록 출력하기",
    "subTitle3" : "3. 상품을 구매한 회원 비율 구하기",
    "subTitle4" : "4. 주문량이 많은 아이스크림을 조회하기",
    "subTitle5" : "5. 저자 별 카테고리 매출액 집계하기",
    "subTitle6" : "6. 조건에 맞는 도서 리스트 출력하기",

    "code1" : "SELECT TO_CHAR(SALES_DATE,'YYYY-MM-DD') AS SALES_DATE\n, PRODUCT_ID\n, USER_ID\n, SALES_AMOUNT\nFROM\n(SELECT A.SALES_DATE\n\t, A.PRODUCT_ID\n\t, A.USER_ID\n\t, A.SALES_AMOUNT\nFROM ONLINE_SALE A\nUNION ALL\nSELECT B.SALES_DATE\n\t, B.PRODUCT_ID\n\t, NULL AS USER_ID\n\t, B.SALES_AMOUNT\nFROM   OFFLINE_SALE B) C\nWHERE  TO_CHAR(SALES_DATE,'YYYY-MM-DD') LIKE '2022-03%'\nORDER BY   SALES_DATE ASC, \n\tPRODUCT_ID ASC,\n\tUSER_ID ASC ",
    "code2" : "SELECT  PT_NAME\n\t, PT_NO\n\t, GEND_CD\n\t, AGE\n\t, CASE \n\tWHEN TLNO IS NULL THEN 'NONE'\n\tWHEN TLNO IS NOT NULL THEN TLNO\n\tEND AS TLNO\nFROM    PATIENT\nWHERE   GEND_CD = 'W' AND AGE <= 12\nORDER BY AGE DESC, PT_NAME ASC",
    "code3" : "WITH JOIN_2021 AS (\n\tSELECT COUNT(DISTINCT F.USER_ID) AS JOIN\n\tFROM USER_INFO F\n\tWHERE TO_CHAR(JOINED,'YYYY-MM-DD') LIKE '2021-%'\n)\n,\nPURCHASE_2021 AS (\n\tSELECT EXTRACT(YEAR FROM SALES_DATE) AS YEAR\n\t, EXTRACT(MONTH FROM SALES_DATE) AS MONTH\n\t, COUNT(DISTINCT N.USER_ID) AS PURCHASED_USERS \n\tFROM JOIN_2021\n\t\t, ONLINE_SALE N INNER JOIN USER_INFO F\n\t\tON N.USER_ID = F.USER_ID \n\t\tAND TO_CHAR(JOINED,'YYYY-MM-DD') LIKE '2021-%'\n\tGROUP BY EXTRACT(YEAR FROM SALES_DATE)\n\t\t, EXTRACT(MONTH FROM SALES_DATE)\n\tORDER BY YEAR ASC\n\t\t, MONTH ASC\n)\nSELECT YEAR\n\t   , MONTH\n\t   , PURCHASED_USERS\n\t   , ROUND(PURCHASED_USERS / JOIN, 1) AS PURCHASED_RATIO\nFROM PURCHASE_2021, JOIN_2021",
    "code4" : "WITH ANS AS\n\t(\nSELECT A.FLAVOR, A.TOTAL_ORDER\nFROM JULY A\n\nUNION ALL\n\nSELECT B.FLAVOR, B.TOTAL_ORDER\nFROM FIRST_HALF B\n)\n\nSELECT FLAVOR\nFROM ANS\nGROUP BY FLAVOR\nORDER BY SUM(ANS.TOTAL_ORDER) DESC\nFETCH NEXT 3 ROWS ONLY",
    "code5" : "WITH BOOK_RES AS (\nSELECT A.AUTHOR_ID, A.BOOK_ID, A.CATEGORY, B.SALES_DATE, (B.SALES*A.PRICE) AS TOTAL_SALES\nFROM BOOK A INNER JOIN BOOK_SALES B ON A.BOOK_ID = B.BOOK_ID\nWHERE EXTRACT(YEAR FROM B.SALES_DATE) = 2022 AND EXTRACT(MONTH FROM B.SALES_DATE) = 1\n)\n\nSELECT B.AUTHOR_ID, B.AUTHOR_NAME, A.CATEGORY, SUM(A.TOTAL_SALES) AS TOTAL_SALES\nFROM BOOK_RES A INNER JOIN AUTHOR B ON A.AUTHOR_ID = B.AUTHOR_ID\nGROUP BY A.CATEGORY, B.AUTHOR_ID, B.AUTHOR_NAME\nORDER BY B.AUTHOR_ID ASC, A.CATEGORY DESC",
    "code6" : "SELECT BOOK_ID\n, TO_CHAR(PUBLISHED_DATE,'YYYY-MM-DD') AS PUBLISHED_DATE\nFROM BOOK\nWHERE CATEGORY = '인문' \nAND EXTRACT(YEAR FROM PUBLISHED_DATE)=2021\nORDER BY PUBLISHED_DATE ASC"
}